<link rel="import" href="{$components_url}bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="{$components_url}bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="{$components_url}bower_components/paper-material/paper-material.html">
<link rel="import" href="{$components_url}bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="{$components_url}bower_components/iron-icons/iron-icons.html">
<link rel="import" href="{$components_url}bower_components/iron-flex-layout/iron-flex-layout.html">

<style is="custom-style">

    paper-toolbar.toolbar-main
    {
        --paper-toolbar-background:#2196F3;
        -moz-box-shadow: 0 0 20px 5px #999;
        -webkit-box-shadow: 0 0 20px 5px #999;
    }
    paper-fab{
        --paper-fab-background:#2196F3;
    }
    paper-header-panel{
        height: 12vh;;
    }

    .title h3{
        color: #ffffff;
    }

    #graph_container{
        width: 48%;
        height: 90vh;
        display: none;
    }

    #topic_container{
        position: relative;
        overflow-x: hidden;
        overflow-y: auto;
        height: 90vh;
        width: 100%;
        margin-left: 30px;
    }

    #pr_body{
        font-family: 'Roboto', sans-serif;
        display: inline-block;
        color: #6c6c6c;
        font-weight: bolder;
        font-size: 20px;
        margin: 30px;
        padding: 50px;
        font-style: italic;
    }

    .q-comments{
        padding-left: 30px;
        width: 90%;

    }


</style>
{literal}
<script>

    var last_selected_element = null;
    window.addEventListener('graph-datalet_node-clicked', function(e){
        if(last_selected_element != null){
            last_selected_element.css('border', 'none');
            last_selected_element.css('font-weight', 'normal');
        }

        if(e.detail.node.id == 0) return;

        var id = SPODPUBLICROOM.original_nodes_ids[e.detail.node.id];

        var curr_element = $("#comment_" + id);
        $(curr_element).css('border', '1px solid #000000');
        $(curr_element).css('font-weight', 'bold');

        $('div[id^="nc_"]').css('display', 'none');
        $(curr_element).parents('div[id^="nc_"]').css('display', 'block');

        $("#topic_container").scrollTop($(curr_element).offset().top);

        last_selected_element = curr_element;
    });

    $(document).ready(function () {
        $('#topic_container').perfectScrollbar();
    });

    slideGraphPanel = function(){
        $('#graph_container').toggle('slide', {direction: 'right'}, 300, function(){
            $('#topic_container').css('width' , ($('#graph_container').css('display') == 'none') ? '100%' : '50%');
        });
    }
</script>
{/literal}

<paper-header-panel>
    <paper-toolbar class="toolbar-main">
        <div class="title"><h3>{$public_room->subject}</h3></div>
        <paper-icon-button paper-drawer-toggle icon="language" onClick="slideGraphPanel()"></paper-icon-button>
    </paper-toolbar>
</paper-header-panel>

<div class="layout horizontal" style="padding-top: 50px; padding-right: 20px;">
        <paper-material id="topic_container" class="layout vertical justified">
            <paper-material elevation="2" id="pr_body">
                {$public_room->body}
            </paper-material>
            {if !empty($comments)}
            <div class="q-comments">
                {$comments}
            </div>
            {/if}
        </paper-material>

        <paper-material elevation="1" animated id="graph_container">
            <paper-toolbar class="toolbar-main">
                <paper-icon-button paper-drawer-toggle icon="assessment" onClick=""></paper-icon-button>
                <paper-icon-button paper-drawer-toggle icon="speaker-notes" onClick=""></paper-icon-button>
            </paper-toolbar>
            <link rel="import" href="{$components_url}datalets/graph-datalet/graph-datalet.html">
            <graph-datalet data='{$graphData}'></graph-datalet>
        </paper-material>
</div>